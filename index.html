<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>WWHook</title>
    <meta name="description" content="An advanced webhook manager for Discord.">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/gh/hung1001/font-awesome-pro@4cac1a6/css/all.css" rel="stylesheet"
        type="text/css" />
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/discord.js@14.14.1/src/index.min.js"></script>


</head>

<body>
    <br>
    <center>
        <h5>WWHook 1.0</h5>
        <h6>An advanced webhook manager for Discord.</h6>
        <br>
        <input type="checkbox" id="debugModecb" name="debugModecb" />
        <label for="debugModecb">Enable Debug Mode <b>(Enables alert output on webhook send)</b></label>
<br>
        <input type="checkbox" id="embedmodecb" name="embedmodecb" />
        <label for="embedmodecb">Embed Mode <b>(WIP)</b></label>
<br>
        <input type="checkbox" id="deletecb" name="deletecb" />
        <label for="deletecb">Webhook Deletion Mode <b></b></label>

        <br>
        <br>
        <label for="url">Webhook URL:</label>
        <input type="text" id="url" name="url"><br><br>
        <div id="config">

        <label for="username">Webhook Username:</label>
        <input type="text" id="username" name="username"><br><br>

        <label for="webhookavatar">Webhook Avatar: (Leave blank to use default)</label>
        <input type="text" id="webhookavatar" name="webhookavatar"><br><br>

        <label for="webhooktext">Webhook Text:</label>
        <input type="text" id="webhooktext" name="webhooktext"><br><br>

        <button onclick="sendWebhook()" id="sendbutton">Send</button>
    </div>
        <button onclick="deleteWebhook()" id="deletebutton">Delete</button>

        <div id="embedconfig">
            <h6>Author Label</h6>
            <label for="embedauthor">Author Name:</label>
            <input type="text" id="embedauthor" name="embedauthor"><br><br>


        </div>
    </center>
</body>

</html>

<script>
    let debugMode = false;
    let embedMode = false;
    
    debugModecb.addEventListener("change", () => {
        if (debugModecb.checked) {
            debugMode = true;
        } else {
            debugMode = false;
        }
    });

    deletecb.addEventListener("change", () => {
        if (deletecb.checked) {
            document.getElementById("config").visibility = "hidden";
            deletebutton.style.visibility = "visible";
        } else {
            document.getElementById("config").visibility = "visible";
            deletebutton.style.visibility = "hidden";
        }
    });

    embedmodecb.addEventListener("change", () => {
        if (embedmodecb.checked) {
            document.getElementById("embedconfig").visibility = "visible";
            embedMode = true;
        } else {
            document.getElementById("embedconfig").visibility = "hidden";
            embedMode = false;
        }
    });


    function sendWebhook() {
        var webhookUrl = document.getElementById("url").value;
        var webhookUsername = document.getElementById("username").value;
        var webhookText = document.getElementById("webhooktext").value;
        var webhookAvatar = document.getElementById("webhookavatar").value;

        var webhookembedAuthor = document.getElementById("embedauthor").value;

        const request = new XMLHttpRequest();
        request.open("POST", webhookUrl);
        request.setRequestHeader('Content-type', 'application/json');

        const params = {
            content: webhookText,
            username: webhookUsername,
            avatar_url: webhookAvatar
        }

        const paramsEmbed = {
            content: webhookText,
            username: webhookUsername,
            avatar_url: webhookAvatar,
            embeds: [
                {
                    "author": {
                        "name": webhookembedAuthor,
                        "url": "https://byeoon.github.io/WWHook",
                        "icon_url": ""
                    }
                }
            ]
        }
        
        if(embedMode == false)
        {
            request.send(JSON.stringify(params));
        }
        else
        {
            request.send(JSON.stringify(paramsEmbed));
        }
        

        if (debugMode == true) {
            alert("WebhookURL: " + webhookUrl);
            alert("Webhook Username: " + webhookUsername);
            alert("Webhook Text: " + webhookText);
            alert("Webhook Avatar: " + webhookAvatar);
            alert("Output: " + JSON.stringify(params));
        }

    }

    function deleteWebhook() {
        var webhookUrl = document.getElementById("url").value;

        fetch(webhookUrl, 
        {
            method: "DELETE"
        }).catch(() => 
        { 
            alert("There was an issue deleting the webhook."); 
        }).then(res => 
        {
            if (res) 
            {
                if (res.status === 204) 
                {
                    alert("Webhook was successfully deleted.");
                }
                else
                {
                    alert("There was an issue deleting the webhook. " + res.status.toString());
                }
            }
        })
    }
</script>